<div class="image-upload-container">
  <div class="image-preview">
    <img [src]="getDisplayImage()" 
         [alt]="uploadType === 'profile' ? 'Profile Image' : 'Project Image'"
         class="preview-image">
    
    <div class="image-overlay" *ngIf="!disabled">
      <button mat-icon-button 
              class="upload-button"
              (click)="fileInput.click()"
              [disabled]="isUploading">
        <mat-icon>{{ hasImage() ? 'edit' : 'add_photo_alternate' }}</mat-icon>
      </button>
      
      <button mat-icon-button 
              class="remove-button"
              (click)="removeImage()"
              *ngIf="hasImage() && !isImageSelected()"
              [disabled]="isUploading">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
  </div>

  <input #fileInput
         type="file"
         accept="image/*"
         (change)="onFileSelected($event)"
         style="display: none;"
         [disabled]="disabled || isUploading">

  <div class="upload-actions" *ngIf="isImageSelected()">
    <div class="upload-progress" *ngIf="isUploading">
      <mat-progress-bar 
        mode="determinate" 
        [value]="uploadProgress">
      </mat-progress-bar>
      <span class="progress-text">{{ uploadProgress }}%</span>
    </div>
    
    <div class="action-buttons" *ngIf="!isUploading">
      <button mat-button 
              color="primary"
              (click)="uploadImage()"
              [disabled]="!selectedFile">
        <mat-icon>cloud_upload</mat-icon>
        Upload
      </button>
      
      <button mat-button 
              (click)="cancelUpload()">
        <mat-icon>cancel</mat-icon>
        Cancel
      </button>
    </div>
  </div>

  <div class="upload-info" *ngIf="!hasImage() && !isImageSelected()">
    <p class="info-text">
      {{ uploadType === 'profile' ? 'Upload a profile image' : 'Upload a project image' }}
    </p>
    <p class="file-requirements">
      Supported formats: JPEG, PNG, GIF, WebP<br>
      Max size: 5MB
    </p>
  </div>
</div>
